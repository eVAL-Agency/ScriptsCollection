# Scripts Collection

A collection of useful scripts for various Linux distributions

## Scripts

| Category / Script | Supports |
|-------------------|----------|
| ![Python](.supplemental/images/icons/python.svg "Python") [Asset Tracking / Collect Asset Inventory (Grist) [Linux]](dist/inventory/linux_inventory_device_to_grist.py) [![README](.supplemental/images/icons/readme.svg "README")](dist/inventory/README.md) | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Asset Tracking / Collect Asset Inventory (Grist) [Windows]](dist/inventory/windows_inventory_device_to_grist.ps1) [![README](.supplemental/images/icons/readme.svg "README")](dist/inventory/README.md) | ![windows](.supplemental/images/icons/windows.svg "Windows 10, 11") |
| ![Python](.supplemental/images/icons/python.svg "Python") [Asset Tracking / Collect Asset Inventory (SuiteCRM) [Linux]](dist/inventory/linux_inventory_device_to_suitecrm.py) [![README](.supplemental/images/icons/readme.svg "README")](dist/inventory/README.md) | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Asset Tracking / Collect Asset Inventory (SuiteCRM) [Windows]](dist/inventory/windows_inventory_device_to_suitecrm.ps1) [![README](.supplemental/images/icons/readme.svg "README")](dist/inventory/README.md) | ![windows](.supplemental/images/icons/windows.svg "Windows 10, 11") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Backup / Backup Nextcloud Server [Linux]](dist/nextcloud/linux_nextcloud_backup.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Disks / Check Disk Health [Linux]](dist/disk/linux_check_disk_health.sh)  | ![archlinux](.supplemental/images/icons/archlinux.svg "Arch") ![centos](.supplemental/images/icons/centos.svg "RHEL-All") ![debian](.supplemental/images/icons/debian.svg "Debian-All") ![fedora](.supplemental/images/icons/fedora.svg "RHEL-All") ![linuxmint](.supplemental/images/icons/linuxmint.svg "Debian-All") ![redhat](.supplemental/images/icons/redhat.svg "RHEL-All") ![rocky](.supplemental/images/icons/rocky.svg "RHEL-All") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Debian-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Disks / Check Disk Health [Windows]](dist/disk/windows_check_disk_health.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows") |
| ![Python](.supplemental/images/icons/python.svg "Python") [Disks / Check Disk Space [Linux]](dist/disk/linux_check_disk_space.py)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Disks / Check Disk Space [Windows]](dist/disk/windows_check_disk_space.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows (All)") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Firewall / Check Firewall Status [Linux]](dist/firewall/linux_check_firewall.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Firewall / Check Firewall Status [Windows]](dist/firewall/windows_check_firewall.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Firewall / Firewall - Allow IP/Port [Linux]](dist/firewall/linux_util_firewall_allow.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Firewall / Firewall - Whitelist IP](dist/firewall/linux_util_firewall_whitelist_ip.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Game Server / Install ARK Survival Ascended Dedicated Server](dist/game-arksurvivalascended/linux_install_game_arksurvivalascended.sh) [![README](.supplemental/images/icons/readme.svg "README")](dist/game-arksurvivalascended/README.md) | ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Game Server / Install Palworld](dist/game-palworld/linux_install_game_palworld.sh)  | ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Game Server / Install Project Zomboid](dist/game-projectzomboid/linux_install_game_zomboid.sh)  | ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Licensing / Get Windows License Information](dist/windows/windows_inventory_get_windows_license.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows 8, 10, 11, Server 2016, Server 2019") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Memory / Check Memory Usage [Linux]](dist/memory/linux_check_memory_usage.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Memory / Check Memory Usage [Windows]](dist/memory/windows_check_memory_usage.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Monitoring / Install Graylog Sidecar [Linux]](dist/graylog/linux_install_graylog_sidecar.sh)  | ![centos](.supplemental/images/icons/centos.svg "CentOS 8, 9") ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![redhat](.supplemental/images/icons/redhat.svg "RHEL 8, 9") ![rocky](.supplemental/images/icons/rocky.svg "Rocky 8, 9") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Monitoring / Install Zabbix Agent2 [Linux]](dist/zabbix/linux_install_zabbix_agent2.sh)  | ![centos](.supplemental/images/icons/centos.svg "CentOS 8, 9") ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![redhat](.supplemental/images/icons/redhat.svg "RHEL 8, 9") ![rocky](.supplemental/images/icons/rocky.svg "Rocky 8, 9") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Monitoring / Install Zabbix Proxy [Linux]](dist/zabbix/linux_install_zabbix_proxy.sh)  | ![centos](.supplemental/images/icons/centos.svg "CentOS 8, 9") ![debian](.supplemental/images/icons/debian.svg "Debian 12") ![redhat](.supplemental/images/icons/redhat.svg "RHEL 8, 9") ![rocky](.supplemental/images/icons/rocky.svg "Rocky 8, 9") ![ubuntu](.supplemental/images/icons/ubuntu.svg "Ubuntu 24.04") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Network Utility / Install net-diag utilities [Linux]](dist/net-diag/linux_install_net_diag.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Networking / Set Hostname and Restart [Windows]](dist/hostname/windows_set_hostname.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Repo / Switch Repo to Community [Proxmox]](dist/proxmox/linux_manage_proxmox_repo_community.sh)  | ![proxmox](.supplemental/images/icons/proxmox.svg "Proxmox") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Security / Check Defender Status [Windows]](dist/defender/windows_check_defender_status.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Security / Install Firewall (UFW) [Linux]](dist/ufw/linux_install_ufw.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Security / Virtualmin Renew All SSL [Linux]](dist/virtualmin/renew-all-letsencrypt-certs.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [System Cleanup / Remove Bloatware in Win10 [Windows]](dist/windows/windows_debloat_win10.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows 10") |
| ![Bash/Shell](.supplemental/images/icons/bash.svg "Bash/Shell") [Updates / Check if Reboot Required [Linux]](dist/updates/linux_check_reboot_required.sh)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![PowerShell](.supplemental/images/icons/powershell.svg "PowerShell") [Updates / Check if Reboot Required [Windows]](dist/updates/windows_check_reboot_required.ps1)  | ![windows](.supplemental/images/icons/windows.svg "Windows 10, 11") |
| ![Python](.supplemental/images/icons/python.svg "Python") [User Management / Authorize SSH Key [Linux]](dist/ssh/linux_util_ssh_authorize.py)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |
| ![Python](.supplemental/images/icons/python.svg "Python") [User Management / Get SSH Public Key [Linux]](dist/ssh/linux_util_ssh_get_key.py)  | ![tux](.supplemental/images/icons/tux.svg "Linux-All") |

## Compile all scripts

Will compile each script into a single distributable file with all dependencies included within.

```bash
python3 compile.py
```

## Script Metadata

Most of the metadata is collected from the file header.
To ensure rendering, please ensure all file headers start with `# `,
and separating lines contain a `#`.

Header scanning will stop as soon as an empty line is encountered.

Example, this will **not** see the "Supports" section as a header field, and thus will not include it.

```bash
#!/bin/bash
#
# Some title

# Supports:
#    Debian 12
```

Correct form includes a '#' to ensure the entire block is seen as the file header.

```bash
#!/bin/bash
#
# Some title
#
# Supports:
#    Debian 12
```

### Script Header

The first non-empty line retrieved from the script will be used as the title, (one line only).

### Syntax

Lists how to run the application to the end user, and gets saved in the help icon in TRMM.

```bash
#/bin/bash
# ...
# Syntax:
#   --option1 - Short description of option 1
#   --option2=... - Short description of option 2
```

```python
#!/usr/bin/env python3
"""
...
Syntax:
	--option1 - Short description of option 1
	--option2=... - Short description of option 2
"""
```

#### Argument Parsing

Adding `# compile:argparse` to the script will generate a dynamic argument parser for the script.

(BASH only) Optionally, you can include the destination variable name before each argument
to allow for dynamic generation of the argument parsing via `compile:argparse`.

In this example, passing `--noninteractive` will set the variable `NONINTERACTIVE` to `1`.

(The compiler will filter out the prefix)

```bash
#/bin/bash
# ...
# Syntax:
#   NONINTERACTIVE=--noninteractive - Run in non-interactive mode, (will not ask for prompts)
#   VERSION=--version=... - Version of Zabbix to install DEFAULT=7.0
#   ZABBIX_SERVER=--server=... - Hostname or IP of Zabbix server
#   ZABBIX_AGENT_HOSTNAME=--hostname=... - Hostname of local device for matching with a Zabbix host entry
# ...

# compile:argparse
```

Generates:

```bash
#/bin/bash
# ...
# Syntax:
#   --noninteractive - Run in non-interactive mode, (will not ask for prompts)
#   --version=... - Version of Zabbix to install DEFAULT=7.0
#   --server=... - Hostname or IP of Zabbix server
#   --hostname=... - Hostname of local device for matching with a Zabbix host entry
# ...

# Parse arguments
NONINTERACTIVE="0"
VERSION="7.0"
ZABBIX_SERVER=""
ZABBIX_AGENT_HOSTNAME=""
while [ "$#" -gt 0 ]; do
	case "$1" in
		--noninteractive) NONINTERACTIVE=1; shift 1;;
		--version=*) VERSION="${1#*=}"; shift 1;;
		--server=*) ZABBIX_SERVER="${1#*=}"; shift 1;;
		--hostname=*) ZABBIX_AGENT_HOSTNAME="${1#*=}"; shift 1;;
		-h|--help) usage;;
	esac
done
if [ -z "$SOURCE" ]; then
	usage
fi
```

```python
#!/usr/bin/env python3
"""
Do something

Syntax:
	--arg1=<str> - Some parameter DEFAULT=yup
	--arg2=<int> - The SSH key to authorize DEFAULT=42
"""

import argparse

# ...

parser = argparse.ArgumentParser(
	prog='scriptname.py',
	description='Does a thing')
# compile:argparse
args = parser.parse_args()
```

#### Variable Type

To support Python, ensure a variable type is specified, like so:

```python
#!/usr/bin/env python3
"""
Syntax:
	--option1=<str> - Short description of option 1
	--option2=<int> - Short description of option 2
"""
```

Argument types in Bash are ignored and are for reference only.

#### Defaults

The default value can be specified by appending `DEFAULT=(value)` to the argument, like so:

```bash
#/bin/bash
# ...
# Syntax:
#   --option1=<str> - Short description of option 1 DEFAULT=default_value
#   --option2=<int> - Short description of option 2 DEFAULT=42
```



### TRMM Arguments

Lists the default arguments and their values to be used when running the script in TRMM.

DOES support TRMM variable replacement for site, client, and agent.
To use these, wrap the variable in double curly braces, like so: `{{client.zabbix_hostname}}`

```bash
#/bin/bash
# ...
# TRMM Arguments:
#   --option1
#   --option2=something
```

```python
#!/usr/bin/env python3
"""
...
Syntax:
	--option1 - Short description of option 1
	--option2=... - Short description of option 2
"""
```

### TRMM Environment

Behaves the same as TRMM Arguments, but is used for environment variables.

```bash
#/bin/bash
# ...
# TRMM Environment:
#   VAR1=something
#   VAR2={{client.zabbix_hostname}}
```

```python
#!/usr/bin/env python3
"""
...
TRMM Environment:
	VAR1=something
	VAR2={{client.zabbix_hostname}}
"""
```

### Supports

Lists the OS support for the script.

```bash
#/bin/bash
# ...
# Supports:
#   Debian 12
#   Ubuntu 24.04
```

```python
#!/usr/bin/env python3
"""
...
Supports:
	Debian 12
	Ubuntu 24.04
"""
```

Distros can be listed individually, or one of the group declarations for multiple distros.

* Linux-All - All Linux-based distros (completely os-agnostic script)
* Debian-All - Any Debian-based distro (Debian, Ubuntu, Mint, etc)
* RHEL-All - Any Red Hat-based distro (RHEL, CentOS, Fedora, etc)
* ArchLinux / arch
* CentOS
* Debian
* Fedora
* LinuxMint
* RedHat / RHEL
* Rocky / RockyLinux
* SuSE / OpenSuSE
* Ubuntu
* Windows

### Author Tag

```bash
#/bin/bash
# ...
# Author:
#   Some Name <some-email@domain.tld>
```

alternative syntax:

```bash
#/bin/bash
# ...
# @AUTHOR  Some Name <some-email@domain.tld>
```

```python
#!/usr/bin/env python3
"""
...
@AUTHOR  Some Name <some-email@domain.tld>
"""
```

### Category Tag

```bash
#/bin/bash
# ...
# Category:
#   Some Category
```

alternative syntax:

```bash
#/bin/bash
# ...
# @CATEGORY  Some Category
```

```python
#!/usr/bin/env python3
"""
...
Category:
	Some Category
"""
```

### TRMM Timeout Setting

```bash
#/bin/bash
# ...
# @TRMM-TIMEOUT  120
```

```python
#!/usr/bin/env python3
"""
...
@TRMM-TIMEOUT  120
"""
```

### Draft

Set to true to skip finalizing of the script.
The script will still be generated to dist/, but will not be recorded in the README and TRMM metafile.

```bash
#/bin/bash
# ...
# Draft:
#   True
```

```python
#!/usr/bin/env python3
"""
...
Draft:
	True
"""
```

## Generative Code

The compiler can generate dynamic code based on script comments, notably for usage and arguments

### Compile usage()

Will generate a "usage()" function with the description and syntax arguments.

```bash
# compile:usage
```


## Scriptlets

Scriptlets are small pieces of reusable code that can be included in scripts during compilation.
This system provides a number of scripts, and more can be added by adding a `compile.sources` file in the root of the project
with the format:

```
scriptlet_type=github:repo_owner/repo_name
```

Where `scriptlet_type` is the directory that contains the scriptlets to include.

By default `main` is used to download sources, but a different branch can be specified by appending `:branch_name`.